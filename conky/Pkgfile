# Description: Light-weight system monitor with lua enabled
# URL:         https://github.com/brndnmtthws/conky
# Maintainer:  Chris Farrell, timcowchip at gmail dot com 
# Depends on:  lua, cairo, curl, glib, imlib2, xorg-libxdamage, xorg-libxext, xorg-libxft, xorg-libxml2, xorg-libxinerama, docbook2x, docbook-xml

name=conky
version=1.10.6
release=1

source=("https://github.com/brndnmtthws/conky/archive/v${version}.tar.gz"
        'lua53.patch')

options=('!strip' 'debug')

build() {
	cd "${SRC}/${name}-${version}"
	patch -p1 -i ../lua53.patch

	cmake \
		-D CMAKE_BUILD_TYPE=Release \
		-D MAINTAINER_MODE=ON \
		-D BUILD_XDBE=ON \
		-D BUILD_IMLIB2=ON \
		-D BUILD_CURL=ON \
		-D BUILD_RSS=ON \
		-D BUILD_WEATHER_METAR=ON \
		-D BUILD_WEATHER_XOAP=ON \
		-D CMAKE_INSTALL_PREFIX=/usr \
		.

	make
        make DESTDIR=$PKG install
	
	install -Dm644 COPYING "${PKG}/usr/share/licenses/${name}/LICENSE"
	install -Dm644 extras/vim/syntax/conkyrc.vim "${PKG}"/usr/share/vim/vimfiles/syntax/conkyrc.vim
	install -Dm644 extras/vim/ftdetect/conkyrc.vim "${PKG}"/usr/share/vim/vimfiles/ftdetect/conkyrc.vim
}
