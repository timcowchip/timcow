# Description:	Program to convert docbook documents to man pages
# URL:		http://docbook2x.sourceforge.net
# Maintainer:  Chris Farrell, timcowchip at gorge dot net 
# Packager:	John Vogel, jvogel4 at stny dot rr dot com
# Depends on:	docbook-xml docbook-xsl p5-xml-sax

name=docbook2x
_name=docbook2X
version=0.8.8
release=4
source=(https://downloads.sourceforge.net/sourceforge/$name/$_name-$version.tar.gz
	01_fix_static_datadir_evaluation.patch
	02_fix_418703_dont_use_abbreviated_sfnet_address.patch
	03_fix_420153_filename_whitespace_handling.patch
	04_fix_442782_preprocessor_declaration_syntax.patch
	05_fix_439214_error_on_missing_refentry.patch
	06_fix_man_typo.patch)

build() {
	chmod -R go-w $_name-$version
	cd $_name-$version

	patch -p1 < $SRC/01_fix_static_datadir_evaluation.patch
	patch -p1 < $SRC/02_fix_418703_dont_use_abbreviated_sfnet_address.patch
	patch -p1 < $SRC/03_fix_420153_filename_whitespace_handling.patch
	patch -p1 < $SRC/04_fix_442782_preprocessor_declaration_syntax.patch
	patch -p1 < $SRC/05_fix_439214_error_on_missing_refentry.patch
	patch -p1 < $SRC/06_fix_man_typo.patch

	./configure \
		--prefix=/usr \
		--program-transform-name='s,^docbook2,docbook2x-,'

	make
	make DESTDIR=$PKG install

	rm -rf $PKG/usr/share/docbook2x
	rm -rf $PKG/usr/share/info
}
