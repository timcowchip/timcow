# Description:	Bluetooth libraries and utilities
# URL:		http://www.bluez.org/
# Maintainer:    Chris Farrell, timcowchip at gorge dot net
# Depends on:	dbus alsa-lib libusb-compat glib
# Optional:	pygobject dbus-python sox gst-plugins-base-compat

name=bluez
version=5.48
release=2
source=("https://www.kernel.org/pub/linux/bluetooth/$name-$version.tar.xz" \ bluetoothd \ 0001-Allow-using-obexd-without-systemd-in-the-user-session.patch \ 0002-bluetoothd-dbus-service.patch \ 0003-bluetooth-group-can-use-bluez.patch)

build() {
	cd $name-$version
	
	patch -p0 -i "${SRC}/0001-Allow-using-obexd-without-systemd-in-the-user-session.patch"
	patch -p0 -i "${SRC}/0002-bluetoothd-dbus-service.patch"
	patch -p0 -i "${SRC}/0003-bluetooth-group-can-use-bluez.patch"
	
	./configure --prefix=/usr \
		--sysconfdir=/etc \
		--localstatedir=/var \
		--libexecdir=/usr/lib \
		--mandir=/usr/share/man \
		--enable-audio \
		--enable-usb \
		--enable-tools \
		--enable-test \
		--enable-hidd \
		--enable-hid2hci \
		--enable-pand \
		--enable-cups \
		--enable-alsa \
		--enable-bccmd \
		--enable-dfutool \
		--enable-dund \
		--enable-sixaxis \
		--enable-threads \
		--enable-library \
		--with-udevdir=/usr/lib/udev \
		--disable-systemd
	make
	make DESTDIR=$PKG install
	install -D -m 0755 $SRC/bluetoothd $PKG/etc/rc.d/bluetoothd
	}
